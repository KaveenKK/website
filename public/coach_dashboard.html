<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Coach Dashboard</title>
  <link rel="stylesheet" href="coach_dashboard.css">
</head>
<body>
<script>
function isPWA() {
  return window.matchMedia('(display-mode: standalone)').matches ||
         window.navigator.standalone ||
         document.referrer.includes('android-app://');
}
const expectedPWA = localStorage.getItem('expectedPWA');
if (expectedPWA !== null) {
  const inPWA = isPWA();
  if ((expectedPWA === 'true' && !inPWA) || (expectedPWA === 'false' && inPWA)) {
    document.body.innerHTML = `
      <div style=\"position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.8);color:#fff;display:flex;align-items:center;justify-content:center;z-index:9999;\">
        <div style=\"background:#222;padding:2rem;border-radius:1rem;text-align:center;max-width:90vw;\">
          <h2>Wrong Context</h2>
          <p>Please open the Nevengi app (PWA) to continue if you started there, or use the browser if you started there.</p>
        </div>
      </div>
    `;
  }
}
</script>
  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" data-tab="dashboard">Dashboard</div>
    <div class="tab" data-tab="subscribers">Subscribers</div>
    <div class="tab" data-tab="invites">Invites</div>
    <div class="tab" data-tab="earnings">Earnings</div>
    <div class="tab" data-tab="starterCourse">Starter Course</div>
  </div>

  <!-- Dashboard -->
  <section id="dashboard" class="tab-content active">
    <h1 id="welcomeGreeting">Welcome, Coach</h1>

    <!-- 1) Coach Application Status Card -->
    <div class="profile-application card">
      <div class="application-status" id="appStatusIndicator">
        Loading application status‚Ä¶
      </div>
      <a class="button" id="applyLink" href="apply_coaching.html" target="_blank">
        Go to Coach Application Form
      </a>
    </div>

    <!-- 2) Profile Section Card -->
    <div class="profile-section card">
      <!-- Picture uploader -->
      <div class="pic-uploader">
        <img id="profilePic" class="profile-pic"
             src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png"
             alt="Profile Picture">
        <label class="upload-label">Change Photo</label>
        <input type="file" id="picUpload" accept="image/*">
      </div>

      <!-- Profile form -->
      <form id="profileForm" class="profile-form">
        <label>Birth Date (18‚Äì80 years):</label>
        <input type="date" name="birthdate" id="birthdate" required>

        <label>Bio:</label>
        <textarea name="bio" rows="3"></textarea>

        <label>Experience:</label>
        <textarea name="experience" rows="3"></textarea>

        <label>YouTube:</label>
        <input type="url" name="youtube" placeholder="https://youtube.com/in/username">

        <label>Facebook:</label>
        <input type="url" name="facebook" placeholder="https://facebook.com/in/username">

        <label>TikTok:</label>
        <input type="url" name="tiktok" placeholder="https://tiktok.com/in/username">

        <label>Instagram:</label>
        <input type="url" name="instagram" placeholder="https://instagram.com/username">

        <label>Threads:</label>
        <input type="url" name="threads" placeholder="https://threads.com/username">

        <label>Twitter:</label>
        <input type="url" name="twitter" placeholder="https://twitter.com/username">

        <label>LinkedIn:</label>
        <input type="url" name="linkedin" placeholder="https://linkedin.com/in/username">

        <label>PayPal Email (for payouts):</label>
        <input type="email" name="paypal">

        <label>Monthly Subscription Price ($0‚Äì$20):</label>
        <input type="number" name="monthly_price_usd" id="usdInput" min="0" max="20" step="0.01" value="0">
        <p><strong>Visible Price to Users:</strong> <span id="mapleDisplay">0</span> üçÅ</p>

        <!-- Form actions -->
        <div class="form-actions">
          <button type="button" id="saveBtn" style="display:none;">Save Profile</button>
          <button type="button" id="editBtn" class="small" style="display:none;">‚úèÔ∏è Edit</button>
        </div>

        <!-- Approval / Publish Status (moved to bottom) -->
        <div class="status" id="approvalStatus">Loading approval status‚Ä¶</div>
      </form>
    </div>

    <!-- Exclusive Video Upload Card -->
    <div class="exclusive-upload card">
      <h2>Upload Exclusive Video</h2>
      <form id="exclusiveUploadForm">
        <label>Title:</label>
        <input type="text" name="title" id="exclusiveTitle" required>

        <label>Description:</label>
        <textarea name="description" id="exclusiveDescription" rows="2"></textarea>

        <label>Niche:</label>
        <input type="text" name="niche" id="exclusiveNiche" required>

        <label>Video File:</label>
        <input type="file" name="video" id="exclusiveVideo" accept="video/*" required>

        <button type="submit" id="exclusiveUploadBtn">Upload Exclusive Video</button>
        <div id="exclusiveUploadStatus" style="margin-top:10px;"></div>
      </form>
    </div>

    <!-- Legal notice Card -->
    <div class="legal card">
      <p><strong>Legal Notice:</strong> You are responsible for your own taxes. Nevengi is not liable for reporting or paying taxes on your earnings. Ensure you comply with local laws.</p>
    </div>
  </section>

  <!-- Subscribers -->
  <section id="subscribers" class="tab-content">
    <h1>Your Subscribers</h1>
    <ul id="subscriberList">
      <li>Loading subscribers‚Ä¶</li>
    </ul>
  </section>

  <!-- Invites -->
  <section id="invites" class="tab-content">
    <h1>Invited Members</h1>
    <ul id="inviteList">
      <li>Loading invited members‚Ä¶</li>
    </ul>
  </section>

  <!-- Earnings -->
  <section id="earnings" class="tab-content">
    <h1>Earnings Overview</h1>
    <canvas id="earningsChart" width="600" height="300"></canvas>
  </section>

  <!-- Starter Course -->
  <section id="starterCourse" class="tab-content">
    <h1>Starter Course for Coaches</h1>
    <div id="courseSlides">
      <div class="course-slide active">
        <img src="https://cdn.pixabay.com/photo/2023/02/28/17/56/ai-generated-7822831_1280.png" alt="Intro">
        <p>Welcome to Nevengi Coaching! Learn how the platform works and your responsibilities.</p>
        <p>If you still haven't joined Nevengi Discord Server, make sure you join before sending your coach application:</p>
        <p>https://discord.gg/6RMPeDmfDd</p>
        <p>If you still haven't completed your coach application, submit it via the following link:</p>
        <p><a href="apply_coaching.html" target="_blank">Apply for Coaching</a></p>
      </div>
      <!-- Other slides unchanged‚Ä¶ -->
      <div class="course-slide">
        <p><strong>Final Step:</strong> Click below to confirm you've completed and understood the starter course &amp; terms.</p>
        <button id="completeCourseBtn">‚úÖ Complete Course</button>
      </div>
    </div>
    <div class="slide-controls">
      <button id="nextBtn">Next</button>
    </div>
  </section>

  <div style="text-align:right;">
    <button id="logoutBtn" style="margin:1rem;">Logout</button>
  </div>
  <script>
    document.getElementById('logoutBtn').addEventListener('click', function() {
      localStorage.removeItem('coachToken');
      localStorage.removeItem('expectedPWA');
      window.location.href = '/';
    });
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js');
    }
  </script>
  <script src="coach_dashboard.js"></script>
  <div id="mobile-hamburger" class="mobile-hamburger">
    <button id="hamburgerBtn" aria-label="Open menu">‚ò∞</button>
    <div id="mobileMenu" class="mobile-menu">
      <button class="menu-close" id="closeMenuBtn">√ó</button>
      <ul>
        <li><button data-tab="dashboard">Dashboard</button></li>
        <li><button data-tab="subscribers">Subscribers</button></li>
        <li><button data-tab="invites">Invites</button></li>
        <li><button data-tab="earnings">Earnings</button></li>
        <li><button data-tab="starterCourse">Starter Course</button></li>
        <li><button id="logoutBtnMobile">Logout</button></li>
      </ul>
    </div>
  </div>
  <nav class="mobile-bottom-nav" id="mobileBottomNav">
    <button data-tab="dashboard"><span>üè†</span><div>Dashboard</div></button>
    <button data-tab="subscribers"><span>üë•</span><div>Subscribers</div></button>
    <button data-tab="invites"><span>‚úâÔ∏è</span><div>Invites</div></button>
    <button data-tab="earnings"><span>üí∞</span><div>Earnings</div></button>
    <button data-tab="starterCourse"><span>üéì</span><div>Course</div></button>
    <button id="moreBtn"><span>‚ò∞</span><div>More</div></button>
  </nav>
</body>
</html>
