<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Coach Dashboard</title>
  <style>
    /* Base Styles */
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      color: #333;
    }
    .container {
      max-width: 1200px;
      margin: 20px auto;
      padding: 20px;
    }
    /* Tabs */
    .tabs {
      display: flex;
      background: #fff;
      border-radius: 8px;
      overflow: hidden;
      margin-bottom: 20px;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 15px;
      cursor: pointer;
      background: #e0e0e0;
      transition: background 0.3s;
    }
    .tab.active {
      background: #fff;
      font-weight: bold;
      border-bottom: 2px solid #007bff;
    }
    .tab-content {
      display: none;
      background: #fff;
      padding: 20px;
      border-radius: 8px;
    }
    .tab-content.active {
      display: block;
    }
    /* Profile Section */
    .profile-section {
      display: flex;
      gap: 20px;
    }
    .profile-card,
    .form-card {
      background: #fff;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      flex: 1;
    }
    .profile-card {
      max-width: 300px;
      text-align: center;
    }
    .profile-card img.profile-pic {
      width: 150px;
      height: 150px;
      border-radius: 50%;
      object-fit: cover;
    }
    .profile-card .upload-label {
      display: inline-block;
      margin-top: 10px;
      padding: 8px 12px;
      background: #007bff;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }
    .profile-card input[type="file"] {
      display: none;
    }
    .profile-card .coach-app {
      margin-top: 30px;
    }
    .profile-card .coach-app h2 {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    .profile-card .coach-app button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      background: #28a745;
      color: #fff;
      cursor: pointer;
    }
    .tick-icon {
      color: #28a745;
      margin-left: 8px;
      display: none;
      vertical-align: middle;
    }
    /* Form Styles */
    form label {
      display: block;
      margin-top: 15px;
      font-weight: 600;
    }
    form input[type="text"],
    form input[type="url"],
    form input[type="email"],
    form input[type="date"],
    form input[type="number"],
    form textarea {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    form textarea { resize: vertical; }
    .button-group {
      margin-top: 20px;
    }
    .button-group button {
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 10px;
    }
    .button-group button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    #saveBtn { background: #007bff; color: #fff; }
    #editBtn { background: #17a2b8; color: #fff; display: none; }
    #publishBtn { background: #6c757d; color: #fff; }
  </style>
</head>
<body>
  <div class="container">
    <!-- Tabs -->
    <div class="tabs">
      <div class="tab active" data-tab="dashboard">Dashboard</div>
      <div class="tab" data-tab="subscribers">Subscribers</div>
      <div class="tab" data-tab="invites">Invites</div>
      <div class="tab" data-tab="earnings">Earnings</div>
      <div class="tab" data-tab="starterCourse">Starter Course</div>
    </div>

    <!-- Dashboard -->
    <section id="dashboard" class="tab-content active">
      <h1>Welcome, Coach</h1>
      <div class="profile-section">
        <!-- Profile & Application Card -->
        <div class="profile-card">
          <img id="profilePic" class="profile-pic" src="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_960_720.png" alt="Profile Picture">
          <label class="upload-label" for="picUpload">Change Photo</label>
          <input type="file" id="picUpload" accept="image/*">

          <div class="coach-app">
            <h2>
              Complete your Coaching Application
              <span id="coachAppTick" class="tick-icon">‚úîÔ∏è</span>
            </h2>
            <button id="openAppForm">Open Application Form</button>
            <p id="coachAppStatusText">Application Pending</p>
          </div>
        </div>

        <!-- Profile Form Card -->
        <div class="form-card">
          <form id="profileForm">
            <label for="birthdate">Birth Date (18‚Äì80 years):</label>
            <input type="date" name="birthdate" id="birthdate" required>

            <label for="bio">Bio:</label>
            <textarea name="bio" id="bio" rows="3"></textarea>

            <label for="specialties">Specialties (comma-separated):</label>
            <input type="text" name="specialties" id="specialties">

            <label for="experience">Experience:</label>
            <textarea name="experience" id="experience" rows="3"></textarea>

            <label for="instagram">Instagram:</label>
            <input type="url" name="instagram" id="instagram" placeholder="https://instagram.com/username">

            <label for="twitter">Twitter:</label>
            <input type="url" name="twitter" id="twitter" placeholder="https://twitter.com/username">

            <label for="linkedin">LinkedIn:</label>
            <input type="url" name="linkedin" id="linkedin" placeholder="https://linkedin.com/in/username">

            <label for="discordTag">Discord Tag:</label>
            <input type="text" name="discordTag" id="discordTag" placeholder="User#1234">

            <label for="paypal">PayPal Email (for payouts):</label>
            <input type="email" name="paypal" id="paypal">

            <label for="monthly_price_usd">Monthly Subscription Price ($0‚Äì$20):</label>
            <input type="number" name="monthly_price_usd" id="monthly_price_usd" min="0" max="20" step="0.01" value="0">
            <p><strong>Visible Price to Users:</strong> <span id="mapleDisplay">0</span> üçÅ</p>

            <div class="button-group">
              <button type="button" id="saveBtn">Save Profile</button>
              <button type="button" id="editBtn">Edit Profile</button>
              <button type="button" id="publishBtn" disabled>Publish Profile</button>
            </div>
          </form>
        </div>
      </div>
    </section>

    <!-- Other tabs omitted for brevity -->
  </div>

  <script>
    // Tab navigation
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab, .tab-content').forEach(el => el.classList.toggle('active', false));
        tab.classList.add('active');
        document.getElementById(tab.getAttribute('data-tab')).classList.add('active');
      });
    });

    // Edit/Save Toggle Logic
    const profileForm = document.getElementById('profileForm');
    const saveBtn = document.getElementById('saveBtn');
    const editBtn = document.getElementById('editBtn');
    let isEditing = true;

    function toggleForm(editable) {
      profileForm.querySelectorAll('input, textarea').forEach(el => el.disabled = !editable);
      saveBtn.style.display = editable ? 'inline-block' : 'none';
      editBtn.style.display = editable ? 'none' : 'inline-block';
    }

    saveBtn.addEventListener('click', () => {
      // TODO: send data to server
      isEditing = false;
      toggleForm(false);
    });

    editBtn.addEventListener('click', () => {
      isEditing = true;
      toggleForm(true);
    });

    // Coach Application State
    let isCoachAppSubmitted = false;
    const tickIcon = document.getElementById('coachAppTick');
    const statusText = document.getElementById('coachAppStatusText');
    const openAppFormBtn = document.getElementById('openAppForm');

    function updateAppState() {
      if (isCoachAppSubmitted) {
        tickIcon.style.display = 'inline';
        statusText.textContent = 'Application Submitted';
        saveBtn.disabled = false;
      } else {
        tickIcon.style.display = 'none';
        statusText.textContent = 'Application Pending';
        saveBtn.disabled = true;
      }
    }

    // Open coach application form in new window
    openAppFormBtn.addEventListener('click', () => {
      const newWin = window.open('apply_coaching.html', 'coachApp');
      // Expect apply_coaching.html to postMessage('coachApplicationSubmitted') when done
    });

    // Listen for completion message
    window.addEventListener('message', e => {
      if (e.data === 'coachApplicationSubmitted') {
        isCoachAppSubmitted = true;
        updateAppState();
      }
    });

    // Initial setup
    toggleForm(true);
    updateAppState();

    // Maple price mapping
    const usdInput = document.getElementById('monthly_price_usd');
    const mapleDisplay = document.getElementById('mapleDisplay');
    usdInput.addEventListener('input', () => {
      mapleDisplay.textContent = (parseFloat(usdInput.value) * 5).toFixed(0);
    });
  </script>
</body>
</html>
